# hotels telegram bot
Данный телеграм-бот предназначен для поиска отелей по заранее заданным критериями.
Для корректной работы бота требуется Python версии не ниже 3.8, а также следующие модули:
- pyTelegramBotAPI==4.4.0
- telebot-calendar==1.2
- python-dotenv==0.19.2
- loguru==0.6.0
- peewee==3.14.9
- requests==2.27.1
- urllib3==1.26.8

### Получение исходных кодов и запуск бота
Получите исходный код бота любым доступным для вас способом и поместите в подготовленную директорию на сервере.
Бот использует технологию поллинга, поэтому дополнительного конфигурирования сервера не требуется.
В составе бота используются следующие файлы:
+ main.py - основной скрипт запуска
  + bots_funks.py - файл, содержащий функции, участвующие в обработке сообщений от пользователя и выдаче информации пользователю.
  + bot_database.py - файл, содержащий функции работы с базой данных. В данном проекте используется база данных sqlite3
  + bot_classes.py - файл, содержащий классы, необходимые для работы бота.
  + .env - файл, содержащий токен подключения бота к серверам Telegram и токен подключения к API hotels.com. Этот файл необходимо создать вручную. Обратите внимание на точку в начале имени файла.
  + requirements.txt - список необходимых зависимостей.
    
#### Получение токенов
Для функционирования бота вам необходимо зарегистрировать бота в Telegram, а также зарегистрироваться на сайте http://rapidapi.com и получить токен для подключения к его API.
Полученные токены необходимо поместить в файл *.env*:
- BOT_TOKEN = 'токен, полученный от botfather в Telegram'
- RAPI_TOKEN = 'токен, полученный от rapidapi.com'

#### Запуск
После установки необходимых зависимостей и проведения первичного конфигурирования можно запускать бота.
Запуск осуществляется командой python main.py
При первом запуске будет создана база данных, содержащая необходимые для функционирования бота таблицы.
После запуска бот станет доступен в Telegram под тем именем, которое вы для него выбрали.

### Взаимодействие с ботом
Бот принимает определенный список команд:
+ /start <br>
вывод приветствия
+ /help <br>
Вывод списка команд для бота
+ /lowprice <br>
Поиск отелей с низкой ценой
+ /highprice <br>
Поиск отелей с высокой ценой
+ /bestdeal <br>
Поиск отелей с ценой  и расстоянием до центра города не большими, чем задано пользователем.
+ /history <br>
Вывод результатов последнего запроса пользователя.
  
После ввода одной из команд, запускающих поиск отелей, начинается цепочка опроса пользователя, по результатам которой формируется ответ, состоящий из списка подходящих под критерии отелей.
Список отелей представляет из себя inline-клавиатуру, содержащую на кнопках краткие описания отелей.
При выборе одного отеля из списка выводится полная информация об отеле, а также пользователю предоставляется выбор: посмотреть изображения отеля или показать результаты последнего запроса.
Новая поисковая цепочка запускается вводом соответствующей команды.
